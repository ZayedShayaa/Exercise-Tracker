<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Exercise Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    input, button { padding: 8px; margin: 6px 0; width: 100%; box-sizing: border-box; }
    h2 { margin-top: 40px; }
    pre { background: #f4f4f4; padding: 10px; }
  </style>
</head>
<body>

<h1>Exercise Tracker</h1>

<section>
  <h2>Create User</h2>
  <form id="create-user-form">
    <input type="text" name="username" placeholder="Username" required />
    <button type="submit">Create User</button>
  </form>
  <pre id="create-user-result"></pre>
</section>

<section>
  <h2>Add Exercise</h2>
  <form id="add-exercise-form">
    <input type="text" name="_id" placeholder="User ID" required />
    <input type="text" name="description" placeholder="Description" required />
    <input type="number" name="duration" placeholder="Duration (minutes)" required />
    <input type="date" name="date" placeholder="Date (optional)" />
    <button type="submit">Add Exercise</button>
  </form>
  <pre id="add-exercise-result"></pre>
</section>

<section>
  <h2>Get User Logs</h2>
  <form id="get-logs-form">
    <input type="text" name="_id" placeholder="User ID" required />
    <input type="date" name="from" placeholder="From (optional)" />
    <input type="date" name="to" placeholder="To (optional)" />
    <input type="number" name="limit" placeholder="Limit (optional)" />
    <button type="submit">Get Logs</button>
  </form>
  <pre id="logs-result"></pre>
</section>

<script>
  const createUserForm = document.getElementById('create-user-form');
  const createUserResult = document.getElementById('create-user-result');
  createUserForm.onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(createUserForm);
    const username = formData.get('username');

    const res = await fetch('/api/users', {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: new URLSearchParams({ username })
    });
    const data = await res.json();
    createUserResult.textContent = JSON.stringify(data, null, 2);
  };

  const addExerciseForm = document.getElementById('add-exercise-form');
  const addExerciseResult = document.getElementById('add-exercise-result');
  addExerciseForm.onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(addExerciseForm);
    const _id = formData.get('_id');
    const description = formData.get('description');
    const duration = formData.get('duration');
    const date = formData.get('date');

    const bodyData = { description, duration };
    if (date) bodyData.date = date;

    const res = await fetch(`/api/users/${_id}/exercises`, {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: new URLSearchParams(bodyData)
    });
    const data = await res.json();
    addExerciseResult.textContent = JSON.stringify(data, null, 2);
  };

  const getLogsForm = document.getElementById('get-logs-form');
  const logsResult = document.getElementById('logs-result');
  getLogsForm.onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(getLogsForm);
    const _id = formData.get('_id');
    const from = formData.get('from');
    const to = formData.get('to');
    const limit = formData.get('limit');

    const params = new URLSearchParams();
    if (from) params.append('from', from);
    if (to) params.append('to', to);
    if (limit) params.append('limit', limit);

    const res = await fetch(`/api/users/${_id}/logs?${params.toString()}`);
    const data = await res.json();
    logsResult.textContent = JSON.stringify(data, null, 2);
  };
</script>

</body>
</html>
